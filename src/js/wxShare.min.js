!function(i,e){WeixinJS="undefined"==typeof WeixinJS?{}:WeixinJS;var n={};WeixinJS.getVideoMetaData=function(){for(var i=document.getElementsByTagName("meta"),e={},t=0;t<i.length;t++){var o=i[t].getAttribute("name"),a=i[t].getAttribute("property"),r=i[t].getAttribute("content")||"";null!=o&&void 0!=o&&0!=o.length||(o=a),null!=o&&void 0!=o&&0!=o.length&&(e[o]=r)}return n=e,e},n=WeixinJS.getVideoMetaData(),WeixinJS.UA=window.navigator.userAgent,WeixinJS.IsWeixin=!(!window.WeixinJSBridge&&!/MicroMessenger/i.test(WeixinJS.UA)),WeixinJS.IsAndroid=!(!/Android|HTC|Adr/i.test(WeixinJS.UA)&&!(window.navigator.platform+"").match(/Linux/i)),WeixinJS.IsIpad=!WeixinJS.IsAndroid&&/iPad/i.test(WeixinJS.UA),WeixinJS.IsIpod=!WeixinJS.IsAndroid&&/iPod/i.test(WeixinJS.UA),WeixinJS.IsIphone=!WeixinJS.IsAndroid&&/iPod|iPhone/i.test(WeixinJS.UA),WeixinJS.IsIOS=WeixinJS.IsIpad||WeixinJS.IsIphone,WeixinJS.dataForWeixin={},WeixinJS.getData=function(i){return n=WeixinJS.getVideoMetaData(),i=i?i:n,WeixinJS.dataForWeixin={appId:WeixinJS._config.appId,imgUrl:i.imgUrl||n["og:image"]||"http://css.tv.itc.cn/global/images/nav1/logo.gif",url:i.url||n["og:url"]||window.location.href,imgWidth:i.width||n["og:imgWidth"]||"300",imgHeight:i.height||n["og:imgHeight"]||"300",title:i.title||n["og:title"]||document.getElementsByTagName("title")[0].text.split(" ")[0]||"",desc:i.description||i.desc||i.content||n.description||n["og:desc"]||document.getElementsByTagName("title")[0].text.split(" ")[0]||"",type:i.type||"",callback:i.callback||function(){}},WeixinJS.dataForWeixin},WeixinJS.success=function(i){},WeixinJS._createNonceStr=function(){return Math.random().toString(36).substr(2,15)},WeixinJS._createTimestamp=function(){return parseInt((new Date).getTime()/1e3)+""},WeixinJS._signature="",WeixinJS._config={debug:!1,url:window.location.href.replace(window.location.hash,""),signature:"",jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","hideMenuItems","showMenuItems","getNetworkType","hideOptionMenu","showOptionMenu"]},WeixinJS._cfgSignature=function(i){return i&&i.signature&&i.appId&&(WeixinJS._config.appId=i.appId,WeixinJS._config.timestamp=i.timestamp,WeixinJS._config.nonceStr=i.nonceStr,WeixinJS._config.signature=i.signature,WeixinJS._signature=i.signature||"",console.log("鎺ュ彛杩斿洖楠岃瘉绛惧悕",i)),WeixinJS._config},WeixinJS.wxShare=function(i){var e=WeixinJS.getData(i);if("undefined"!=typeof e&&WeixinJS.IsWeixin){if(WeixinJS.IsWeixin&&/tv\.sohu\.com/i.test(e.url))try{var n=e.url;n=n.replace(/http:\/\/tv\.sohu\.com/i,"http://wx.m.tv.sohu.com"),n=n.replace(/http:\/\/my\.tv\.sohu\.com/i,"http://wx.m.tv.sohu.com"),e.url=n}catch(t){}WeixinJS.shareData={title:e.title,desc:e.desc,imgUrl:e.imgUrl,link:e.url,type:e.type||"link",dataUrl:e.dataUrl||"",success:WeixinJS.success,cancel:WeixinJS.cancel,fail:WeixinJS.fail},!e.type||"video"!=e.type&&"music"!=e.type||(WeixinJS.shareData.type=e.type||"",WeixinJS.shareData.data_url=e.url||""),WeixinJS.bindEvents=function(i){i=i||WeixinJS.shareData,console.log("wxready淇℃伅 --> OK"),wx.checkJsApi({jsApiList:WeixinJS._config.jsApiList,success:function(i){WeixinJS.checkJsApi(i)}}),wx.showOptionMenu(),wx.onMenuShareAppMessage(i),wx.onMenuShareTimeline(i),wx.onMenuShareQQ(i),wx.onMenuShareWeibo(i),wx.onMenuShareQZone(i),wx.getNetworkType({success:function(i){WeixinJS.networkType=i.networkType},fail:function(i){WeixinJS.networkType=null}})},window.wxJsVerify=function(i){if("undefined"!=typeof wx&&i&&i.signature&&i.appId)WeixinJS._config.appId=i.appId,WeixinJS._config.timestamp=i.timestamp,WeixinJS._config.nonceStr=i.nonceStr,WeixinJS._config.signature=i.signature,WeixinJS._signature=i.signature||"",console.log("wx.config 淇℃伅 -->",WeixinJS._config),wx.config(WeixinJS._config),console.log("shareData淇℃伅 -->",WeixinJS.shareData),wx.ready(function(){WeixinJS.bindEvents(WeixinJS.shareData),console.log("wx ready bindEvents OK!")}),wx.error(function(i){console.log("wx check error",i)});else{console.log("鏈嶅姟绔獙璇佺鍚嶉敊璇�,鐢ㄦ棫鎺ュ彛");var n={appid:"",img_url:e.imgUrl,img_width:e.imgWidth,img_height:e.imgHeight,link:e.url||location.href,desc:e.desc||"",title:e.title||""};!e.type||"video"!=e.type&&"music"!=e.type||(n.type=e.type||"",n.data_url=e.url||""),console.log("shareData淇℃伅 -->",n),"undefined"!=typeof WeixinJSBridge&&(WeixinJSBridge.on("menu:share:timeline",function(i){WeixinJSBridge.invoke("shareTimeline",n,function(i){})}),WeixinJSBridge.on("menu:share:appmessage",function(i){WeixinJSBridge.invoke("sendAppMessage",n,function(i){})}),WeixinJSBridge.on("menu:share:qq",function(i){WeixinJSBridge.invoke("shareQQ",n,function(i){})}),WeixinJSBridge.on("menu:share:weiboApp",function(i){WeixinJSBridge.invoke("shareWeiboApp",n,function(i){})}),WeixinJSBridge.on("menu:share:QZone",function(i){WeixinJSBridge.invoke("shareQZone",n,function(i){})}))}},function(){var i="https:"===document.location.protocol?"https://":"http://",e="m.tv.sohu.com";/t\.m\.tv\.sohu\.com|t1\.m\.tv\.sohu\.com|\d+|\.\d+|\.\d+|\.\d+/i.test(window.location.host)&&(e="t.m.tv.sohu.com");var n=document.createElement("script"),t=i+e+"/wxauth/jsticket/signature?callback=wxJsVerify&url="+WeixinJS._config.url+"&_rd="+(new Date).getTime();console.log(t),n.src=t,console.log(n),document.body.appendChild(n)}()}},WeixinJS.chkJSB=WeixinJS.wxShare,WeixinJS.init=function(e){i(document).ready(function(){return WeixinJS.IsWeixin?void WeixinJS.wxShare(e):void console.log("not  Support weixin ,pls check WeixinJS.IsWeixin"+WeixinJS.IsWeixin)})},WeixinJS.getConfig=function(e){e=e||function(){};try{if(!WeixinJS.IsWeixin||"undefined"==typeof wx)return void console.log("涓嶅湪寰俊瀹㈡埛绔唴 ",WeixinJS.IsWeixin);var n="https:"===document.location.protocol?"https://":"http://",t="m.tv.sohu.com";WeixinJS._config.url=window.location.href.replace(window.location.hash,""),/t\.m\.tv\.sohu\.com|t1\.m\.tv\.sohu\.com|\d+|\.\d+|\.\d+|\.\d+/i.test(window.location.host)&&(t="t.m.tv.sohu.com");var o=n+t+"/wxauth/jsticket/signature?url="+WeixinJS._config.url;console.log(o),i.ajax({url:o,type:"get",dataType:"jsonp",cache:!1,success:function(i){console.log("ajax鎺ュ彛杩斿洖楠岃瘉绛惧悕",i),i&&i.signature?(WeixinJS._cfgSignature(i),e(WeixinJS._config)):e(WeixinJS._config)},error:function(){e(WeixinJS._config)}})}catch(a){e(WeixinJS._config)}},window.WeixinJS=WeixinJS,WeixinJS.init(),"function"==typeof define&&define("WeixinApi",function(require,exports,module){module.exports=WeixinJS})}(window.Zepto||window.jQuery,window);